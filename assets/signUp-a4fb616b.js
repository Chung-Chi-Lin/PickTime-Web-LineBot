import{S as l,_}from"./check-ec0ec9dc.js";import{_ as b}from"./img-2f7f45e2.js";import{_ as w,r as h,o as x,c as y,a as t,w as f,b as e,d as I,e as k,n as m}from"./index-3c7f28d3.js";const L={mounted(){this.checkUserSwal()},data(){return{user:{userName:"",email:"",password:"",confirmPwd:"",userType:"",lineId:"",confirmLineId:""},isLoading:!1,hasUser:!1}},methods:{checkUserSwal(){l.fire({title:"請輸入您的Line Id",input:"text",inputLabel:"注意: 非名稱而是ID驗證碼",inputAttributes:{autocomplete:"new-password"},showCancelButton:!0,confirmButtonText:"確認",cancelButtonText:"取消",inputValidator:n=>n?null:"您需要輸入一些文字！"}).then(n=>{n.isConfirmed&&this.$http.get(`https://todolist-sql.onrender.com/api/check-line-id?lineId=${n.value}`).then(s=>{const{userInfo:r}=s.data;if(!s.data.found){l.fire("Line ID 不存在","請先於 line 官方帳號註冊用戶","error"),this.user.userType="";return}l.fire({title:`請問您是用戶 ${r.lineUserName} 嗎?`,confirmButtonText:"確認",cancelButtonText:"取消",showCancelButton:!0}).then(p=>{p.isConfirmed&&(this.user.confirmLineId=n.value,this.user.lineId=n.value,this.hasUser=!0,this.user.userType=r.lineUserType,l.fire(`歡迎您! ${r.lineUserName}，請開始註冊帳號`))})}).catch(s=>{console.error("錯誤:",s),this.user.userType=""})})},signUp(){if(!this.hasUser){l.fire({title:"請先進行用戶驗證",text:"請確認是否為 Line 綁定用戶，已有帳號密碼請按登入鈕",icon:"error",confirmButtonText:"了解"});return}if(this.user.confirmLineId!==this.user.lineId){l.fire({title:"請重新點擊用戶驗證",text:"LineID 與 用戶驗證ID需一致，請重新進行用戶驗證",icon:"error",confirmButtonText:"了解"});return}const n="https://todolist-sql.onrender.com/api/users/register",s={email:this.user.email,name:this.user.userName,userType:this.user.userType,password:this.user.password,lineId:this.user.lineId};this.isLoading=!0,this.user.password===this.user.confirmPwd?this.$http.post(n,s).then(r=>{this.isLoading=!1,l.fire({title:r.data.message,text:"歡迎您 ! 請輸入帳號密碼開始使用待辦清單功能 !",icon:"success",confirmButtonText:"了解"}).then(this.$router.push("/"))}).catch(r=>{this.isLoading=!1,l.fire({title:r.response.data.message,text:"請確認是否已重複註冊帳號，已有帳號密碼請按登入鈕",icon:"error",confirmButtonText:"了解"})}):(this.isLoading=!1,l.fire({title:"失敗",text:"請再次輸入密碼",icon:"error",confirmButtonText:"了解"}))},goLogin(){this.$router.push("/")}},computed:{isFormValid(){return this.user.confirmPwd===this.user.password&&this.user.userName&&this.user.userType&&this.user.email}}},V={class:"container pt-5"},T=e("div",{class:"loadingio-spinner-bean-eater-iylmkqp50l"},[e("div",{class:"ldio-t0eby9sr4hr"},[e("div",null,[e("div"),e("div"),e("div")]),e("div",null,[e("div"),e("div"),e("div")])])],-1),U={class:"row p-md-5"},B=e("div",{class:"col-6 me-5 d-none d-md-block align-self-center"},[e("h1",{class:"f-Baloo fw-bold h2 ps-3"},[e("img",{src:_,alt:"checkbox",style:{height:"55px"}}),I(" LineBot Pick Time ")]),e("img",{src:b,class:"img-fluid",alt:"todoMan"})],-1),N={class:"col"},E=k('<h2 class="mt-5 h3 d-none d-md-block ps-2">註冊帳號</h2><div class="text-center d-inline d-md-none"><h1 class="f-Baloo fw-bold"><img src="'+_+'" alt="checkbox"> ONLINE TODO LIST </h1><h2 class="h5">註冊帳號</h2></div>',2),C={class:"text-end"},q={class:"form-group"},P=e("label",{for:"Email"},"Email",-1),S={class:"form-group mt-3"},D=e("label",{for:"name"},"您的暱稱",-1),M={class:"form-group mt-3"},O=e("label",{for:"pwd"},"密碼",-1),F={class:"form-group my-3"},z=e("label",{for:"confirmPwd"},"再次輸入密碼",-1),A={class:"form-group mt-3"},j=e("label",{for:"lineId"},"Line ID",-1),G={class:"d-grid gap-4 col-4 mx-auto pt-4"},H=["disabled"];function J(n,s,r,p,o,a){const g=h("loading"),c=h("v-field"),u=h("ErrorMessage"),v=h("v-form");return x(),y("main",V,[t(g,{active:o.isLoading},{default:f(()=>[T]),_:1},8,["active"]),e("div",U,[B,e("div",N,[E,e("div",C,[e("button",{class:"btn btn-primary me-3",type:"button",onClick:s[0]||(s[0]=(...d)=>a.checkUserSwal&&a.checkUserSwal(...d))},"用戶驗證 ")]),t(v,{class:"container"},{default:f(({errors:d})=>[e("div",q,[P,t(c,{id:"Email",name:"Email欄位",type:"text",class:m(["form-control",{"is-invalid":d.Email欄位}]),placeholder:"請輸入Email",rules:"email|required",modelValue:o.user.email,"onUpdate:modelValue":s[1]||(s[1]=i=>o.user.email=i),style:{height:"70px"}},null,8,["class","modelValue"]),t(u,{name:"Email欄位",class:"invalid-feedback"})]),e("div",S,[D,t(c,{id:"name",name:"暱稱",type:"name",class:m(["form-control",{"is-invalid":d.暱稱}]),placeholder:"請輸入您的暱稱",rules:"required",modelValue:o.user.userName,"onUpdate:modelValue":s[2]||(s[2]=i=>o.user.userName=i),style:{height:"70px"}},null,8,["class","modelValue"]),t(u,{name:"暱稱",class:"invalid-feedback"})]),e("div",M,[O,t(c,{id:"pwd",name:"密碼",type:"password",class:m(["form-control",{"is-invalid":d.密碼}]),placeholder:"請輸入密碼",rules:"required|min:6",modelValue:o.user.password,"onUpdate:modelValue":s[3]||(s[3]=i=>o.user.password=i),style:{height:"70px"}},null,8,["class","modelValue"]),t(u,{name:"密碼",class:"invalid-feedback"})]),e("div",F,[z,t(c,{id:"confirmPwd",name:"此密碼欄位",type:"password",class:m(["form-control",{"is-invalid":d.此密碼欄位}]),placeholder:"請再次輸入密碼",rules:"required|min:6|confirmed:@密碼",modelValue:o.user.confirmPwd,"onUpdate:modelValue":s[4]||(s[4]=i=>o.user.confirmPwd=i),style:{height:"70px"}},null,8,["class","modelValue"]),t(u,{name:"此密碼欄位",class:"invalid-feedback"})]),e("div",A,[j,t(c,{id:"lineId",name:"lineId",type:"name",class:m(["form-control",{"is-invalid":d.lineId}]),placeholder:"請輸入您的LineID",rules:"required",modelValue:o.user.lineId,"onUpdate:modelValue":s[5]||(s[5]=i=>o.user.lineId=i),style:{height:"70px"}},null,8,["class","modelValue"]),t(u,{name:"lineId",class:"invalid-feedback"})]),e("div",G,[e("button",{class:"btn btn-dark py-md-3",type:"button",onClick:s[6]||(s[6]=(...i)=>a.signUp&&a.signUp(...i)),disabled:!a.isFormValid}," 註冊帳號 ",8,H),e("button",{class:"btn btn-h",type:"button",onClick:s[7]||(s[7]=(...i)=>a.goLogin&&a.goLogin(...i))},"登入")])]),_:1})])])])}const W=w(L,[["render",J]]);export{W as default};
